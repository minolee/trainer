Search.setIndex({"alltitles": {"Contents:": [[0, null]], "Module contents": [[2, "module-src"], [3, "module-src.base"], [4, "module-src.data"], [5, "module-src.launcher"], [6, "module-src.model"], [7, "module-src.tokenizer"], [8, "module-src.trainer"], [9, "module-src.utils"]], "Submodules": [[2, "submodules"], [3, "submodules"], [4, "submodules"], [5, "submodules"], [6, "submodules"], [7, "submodules"], [8, "submodules"], [9, "submodules"]], "Subpackages": [[2, "subpackages"]], "Trainer documentation": [[0, null]], "src": [[1, null]], "src package": [[2, null]], "src.base package": [[3, null]], "src.base.base_config module": [[3, "module-src.base.base_config"]], "src.base.base_instance module": [[3, "module-src.base.base_instance"]], "src.base.base_message module": [[3, "module-src.base.base_message"]], "src.data package": [[4, null]], "src.data.config module": [[4, "module-src.data.config"]], "src.data.filter module": [[4, "module-src.data.filter"]], "src.data.formatter module": [[4, "module-src.data.formatter"]], "src.data.reader module": [[4, "module-src.data.reader"]], "src.env module": [[2, "module-src.env"]], "src.launcher package": [[5, null]], "src.launcher.launcher module": [[5, "module-src.launcher.launcher"]], "src.model package": [[6, null]], "src.model.config module": [[6, "module-src.model.config"]], "src.tokenizer package": [[7, null]], "src.tokenizer.config module": [[7, "module-src.tokenizer.config"]], "src.trainer package": [[8, null]], "src.trainer.config module": [[8, "module-src.trainer.config"]], "src.trainer.postprocess_trainer module": [[8, "module-src.trainer.postprocess_trainer"]], "src.trainer.preprocess_args module": [[8, "module-src.trainer.preprocess_args"]], "src.utils package": [[9, null]], "src.utils.custom module": [[9, "module-src.utils.custom"]], "src.utils.deepspeed_util module": [[9, "src-utils-deepspeed-util-module"]], "src.utils.file_util module": [[9, "module-src.utils.file_util"]], "src.utils.func_util module": [[9, "module-src.utils.func_util"]], "src.utils.list_util module": [[9, "module-src.utils.list_util"]], "src.utils.node module": [[9, "module-src.utils.node"]], "src.utils.rank module": [[9, "module-src.utils.rank"]]}, "docnames": ["index", "modules", "src", "src.base", "src.data", "src.launcher", "src.model", "src.tokenizer", "src.trainer", "src.utils"], "envversion": {"sphinx": 64, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1}, "filenames": ["index.rst", "modules.rst", "src.rst", "src.base.rst", "src.data.rst", "src.launcher.rst", "src.model.rst", "src.tokenizer.rst", "src.trainer.rst", "src.utils.rst"], "indexentries": {"accelerate_config (src.launcher.launcher.launcherconfig attribute)": [[5, "src.launcher.launcher.LauncherConfig.accelerate_config", false]], "as_callable() (in module src.trainer.preprocess_args)": [[8, "src.trainer.preprocess_args.as_callable", false]], "autocast() (in module src.utils.func_util)": [[9, "src.utils.func_util.autocast", false]], "baseconfig (class in src.base.base_config)": [[3, "src.base.base_config.BaseConfig", false]], "basemessage (class in src.base.base_message)": [[3, "src.base.base_message.BaseMessage", false]], "callconfig (class in src.base.base_config)": [[3, "src.base.base_config.CallConfig", false]], "concat() (in module src.utils.list_util)": [[9, "src.utils.list_util.concat", false]], "create_accelerate_args() (src.launcher.launcher.launcherconfig method)": [[5, "src.launcher.launcher.LauncherConfig.create_accelerate_args", false]], "create_get_fn() (in module src.utils.func_util)": [[9, "src.utils.func_util.create_get_fn", false]], "create_register_deco() (in module src.utils.func_util)": [[9, "src.utils.func_util.create_register_deco", false]], "create_trainer() (in module src.trainer.config)": [[8, "src.trainer.config.create_trainer", false]], "custom_builder (src.data.config.dataconfig attribute)": [[4, "src.data.config.DataConfig.custom_builder", false]], "custom_builder (src.data.config.dataelem attribute)": [[4, "src.data.config.DataElem.custom_builder", false]], "data (src.trainer.config.trainconfig attribute)": [[8, "src.trainer.config.TrainConfig.data", false]], "data_index (src.base.base_instance.instance attribute)": [[3, "src.base.base_instance.Instance.data_index", false]], "data_source (src.base.base_instance.instance attribute)": [[3, "src.base.base_instance.Instance.data_source", false]], "dataconfig (class in src.data.config)": [[4, "src.data.config.DataConfig", false]], "dataelem (class in src.data.config)": [[4, "src.data.config.DataElem", false]], "dataset (src.data.config.dataelem attribute)": [[4, "src.data.config.DataElem.dataset", false]], "deepspeed_config (src.launcher.launcher.launcherconfig attribute)": [[5, "src.launcher.launcher.LauncherConfig.deepspeed_config", false]], "deepspeed_stage (src.trainer.config.trainconfig attribute)": [[8, "src.trainer.config.TrainConfig.deepspeed_stage", false]], "device (src.model.config.modelconfig attribute)": [[6, "src.model.config.ModelConfig.device", false]], "drop_unused_args() (in module src.utils.func_util)": [[9, "src.utils.func_util.drop_unused_args", false]], "dump() (src.base.base_config.baseconfig method)": [[3, "src.base.base_config.BaseConfig.dump", false]], "elem (src.base.base_instance.instance attribute)": [[3, "src.base.base_instance.Instance.elem", false]], "filter (src.data.config.dataconfig attribute)": [[4, "src.data.config.DataConfig.filter", false]], "filter (src.data.config.dataelem attribute)": [[4, "src.data.config.DataElem.filter", false]], "formatter (src.data.config.dataconfig attribute)": [[4, "src.data.config.DataConfig.formatter", false]], "formatter (src.data.config.dataelem attribute)": [[4, "src.data.config.DataElem.formatter", false]], "get_filter() (in module src.data.filter)": [[4, "src.data.filter.get_filter", false]], "get_formatter() (in module src.data.formatter)": [[4, "src.data.formatter.get_formatter", false]], "get_kwargs() (src.base.base_config.callconfig method)": [[3, "src.base.base_config.CallConfig.get_kwargs", false]], "get_reader() (in module src.data.reader)": [[4, "src.data.reader.get_reader", false]], "info() (src.data.config.dataconfig method)": [[4, "src.data.config.DataConfig.info", false]], "info() (src.data.config.dataelem method)": [[4, "src.data.config.DataElem.info", false]], "instance (class in src.base.base_instance)": [[3, "src.base.base_instance.Instance", false]], "is_accelerate (src.trainer.config.trainconfig attribute)": [[8, "src.trainer.config.TrainConfig.is_accelerate", false]], "is_deepspeed (src.launcher.launcher.launcherconfig property)": [[5, "src.launcher.launcher.LauncherConfig.is_deepspeed", false]], "is_deepspeed (src.trainer.config.trainconfig attribute)": [[8, "src.trainer.config.TrainConfig.is_deepspeed", false]], "is_localhost() (in module src.utils.node)": [[9, "src.utils.node.is_localhost", false]], "is_main (src.launcher.launcher.launcherconfig attribute)": [[5, "src.launcher.launcher.LauncherConfig.is_main", false]], "is_rank_zero() (in module src.utils.rank)": [[9, "src.utils.rank.is_rank_zero", false]], "iter_dir() (in module src.utils.file_util)": [[9, "src.utils.file_util.iter_dir", false]], "launcherconfig (class in src.launcher.launcher)": [[5, "src.launcher.launcher.LauncherConfig", false]], "limit (src.data.config.dataelem attribute)": [[4, "src.data.config.DataElem.limit", false]], "load() (src.base.base_config.baseconfig class method)": [[3, "src.base.base_config.BaseConfig.load", false]], "load_module() (in module src.utils.custom)": [[9, "src.utils.custom.load_module", false]], "load_weight (src.model.config.modelconfig attribute)": [[6, "src.model.config.ModelConfig.load_weight", false]], "local_rank (src.launcher.launcher.launcherconfig attribute)": [[5, "src.launcher.launcher.LauncherConfig.local_rank", false]], "loss (src.trainer.config.trainconfig attribute)": [[8, "src.trainer.config.TrainConfig.loss", false]], "loss() (in module src.trainer.preprocess_args)": [[8, "src.trainer.preprocess_args.loss", false]], "message (src.base.base_message.basemessage attribute)": [[3, "src.base.base_message.BaseMessage.message", false]], "model (src.trainer.config.trainconfig attribute)": [[8, "src.trainer.config.TrainConfig.model", false]], "model_config (src.base.base_config.baseconfig attribute)": [[3, "src.base.base_config.BaseConfig.model_config", false]], "model_config (src.base.base_config.callconfig attribute)": [[3, "src.base.base_config.CallConfig.model_config", false]], "model_config (src.base.base_instance.instance attribute)": [[3, "src.base.base_instance.Instance.model_config", false]], "model_config (src.base.base_message.basemessage attribute)": [[3, "src.base.base_message.BaseMessage.model_config", false]], "model_config (src.base.base_message.passage attribute)": [[3, "src.base.base_message.Passage.model_config", false]], "model_config (src.base.base_message.preferencemessage attribute)": [[3, "src.base.base_message.PreferenceMessage.model_config", false]], "model_config (src.data.config.dataconfig attribute)": [[4, "src.data.config.DataConfig.model_config", false]], "model_config (src.data.config.dataelem attribute)": [[4, "src.data.config.DataElem.model_config", false]], "model_config (src.launcher.launcher.launcherconfig attribute)": [[5, "src.launcher.launcher.LauncherConfig.model_config", false]], "model_config (src.model.config.modelconfig attribute)": [[6, "src.model.config.ModelConfig.model_config", false]], "model_config (src.tokenizer.config.tokenizerconfig attribute)": [[7, "src.tokenizer.config.TokenizerConfig.model_config", false]], "model_config (src.trainer.config.trainconfig attribute)": [[8, "src.trainer.config.TrainConfig.model_config", false]], "model_name (src.trainer.config.trainconfig attribute)": [[8, "src.trainer.config.TrainConfig.model_name", false]], "model_type (src.model.config.modelconfig attribute)": [[6, "src.model.config.ModelConfig.model_type", false]], "modelconfig (class in src.model.config)": [[6, "src.model.config.ModelConfig", false]], "module": [[2, "module-src", false], [2, "module-src.env", false], [3, "module-src.base", false], [3, "module-src.base.base_config", false], [3, "module-src.base.base_instance", false], [3, "module-src.base.base_message", false], [4, "module-src.data", false], [4, "module-src.data.config", false], [4, "module-src.data.filter", false], [4, "module-src.data.formatter", false], [4, "module-src.data.reader", false], [5, "module-src.launcher", false], [5, "module-src.launcher.launcher", false], [6, "module-src.model", false], [6, "module-src.model.config", false], [7, "module-src.tokenizer", false], [7, "module-src.tokenizer.config", false], [8, "module-src.trainer", false], [8, "module-src.trainer.config", false], [8, "module-src.trainer.postprocess_trainer", false], [8, "module-src.trainer.preprocess_args", false], [9, "module-src.utils", false], [9, "module-src.utils.custom", false], [9, "module-src.utils.file_util", false], [9, "module-src.utils.func_util", false], [9, "module-src.utils.list_util", false], [9, "module-src.utils.node", false], [9, "module-src.utils.rank", false]], "name (src.base.base_config.callconfig attribute)": [[3, "src.base.base_config.CallConfig.name", false]], "name (src.data.config.dataelem attribute)": [[4, "src.data.config.DataElem.name", false]], "nodes (src.launcher.launcher.launcherconfig attribute)": [[5, "src.launcher.launcher.LauncherConfig.nodes", false]], "optimizer (src.trainer.config.trainconfig attribute)": [[8, "src.trainer.config.TrainConfig.optimizer", false]], "optimizer() (in module src.trainer.preprocess_args)": [[8, "src.trainer.preprocess_args.optimizer", false]], "parse_nodelist() (in module src.utils.node)": [[9, "src.utils.node.parse_nodelist", false]], "passage (class in src.base.base_message)": [[3, "src.base.base_message.Passage", false]], "passage (src.base.base_message.passage attribute)": [[3, "src.base.base_message.Passage.passage", false]], "passage_title (src.base.base_message.passage attribute)": [[3, "src.base.base_message.Passage.passage_title", false]], "passages (src.base.base_instance.instance attribute)": [[3, "src.base.base_instance.Instance.passages", false]], "path (src.model.config.modelconfig attribute)": [[6, "src.model.config.ModelConfig.path", false]], "path (src.tokenizer.config.tokenizerconfig attribute)": [[7, "src.tokenizer.config.TokenizerConfig.path", false]], "preferencemessage (class in src.base.base_message)": [[3, "src.base.base_message.PreferenceMessage", false]], "process_speaker() (src.base.base_message.basemessage class method)": [[3, "src.base.base_message.BaseMessage.process_speaker", false]], "rank() (in module src.utils.rank)": [[9, "src.utils.rank.rank", false]], "rank_iter() (in module src.utils.rank)": [[9, "src.utils.rank.rank_iter", false]], "rank_zero_only() (in module src.utils.rank)": [[9, "src.utils.rank.rank_zero_only", false]], "rank_zero_print() (in module src.utils.rank)": [[9, "src.utils.rank.rank_zero_print", false]], "raw_reader (src.data.config.dataelem attribute)": [[4, "src.data.config.DataElem.raw_reader", false]], "read_csv() (in module src.utils.file_util)": [[9, "src.utils.file_util.read_csv", false]], "read_jsonl() (in module src.utils.file_util)": [[9, "src.utils.file_util.read_jsonl", false]], "read_magic() (in module src.utils.file_util)": [[9, "src.utils.file_util.read_magic", false]], "read_tsv() (in module src.utils.file_util)": [[9, "src.utils.file_util.read_tsv", false]], "read_txt() (in module src.utils.file_util)": [[9, "src.utils.file_util.read_txt", false]], "read_yaml() (in module src.utils.file_util)": [[9, "src.utils.file_util.read_yaml", false]], "reader (src.data.config.dataconfig attribute)": [[4, "src.data.config.DataConfig.reader", false]], "reader (src.data.config.dataelem attribute)": [[4, "src.data.config.DataElem.reader", false]], "rejected_message (src.base.base_message.preferencemessage attribute)": [[3, "src.base.base_message.PreferenceMessage.rejected_message", false]], "reward_funcs() (in module src.trainer.preprocess_args)": [[8, "src.trainer.preprocess_args.reward_funcs", false]], "run_config (src.launcher.launcher.launcherconfig attribute)": [[5, "src.launcher.launcher.LauncherConfig.run_config", false]], "save_dir (src.trainer.config.trainconfig property)": [[8, "src.trainer.config.TrainConfig.save_dir", false]], "scheduler (src.trainer.config.trainconfig attribute)": [[8, "src.trainer.config.TrainConfig.scheduler", false]], "sfttrainer() (in module src.trainer.postprocess_trainer)": [[8, "src.trainer.postprocess_trainer.SFTTrainer", false]], "source (src.data.config.dataelem attribute)": [[4, "src.data.config.DataElem.source", false]], "sources (src.data.config.dataconfig attribute)": [[4, "src.data.config.DataConfig.sources", false]], "speaker (src.base.base_message.basemessage attribute)": [[3, "src.base.base_message.BaseMessage.speaker", false]], "split (src.data.config.dataelem attribute)": [[4, "src.data.config.DataElem.split", false]], "split_dev (src.data.config.dataelem attribute)": [[4, "src.data.config.DataElem.split_dev", false]], "src": [[2, "module-src", false]], "src.base": [[3, "module-src.base", false]], "src.base.base_config": [[3, "module-src.base.base_config", false]], "src.base.base_instance": [[3, "module-src.base.base_instance", false]], "src.base.base_message": [[3, "module-src.base.base_message", false]], "src.data": [[4, "module-src.data", false]], "src.data.config": [[4, "module-src.data.config", false]], "src.data.filter": [[4, "module-src.data.filter", false]], "src.data.formatter": [[4, "module-src.data.formatter", false]], "src.data.reader": [[4, "module-src.data.reader", false]], "src.env": [[2, "module-src.env", false]], "src.launcher": [[5, "module-src.launcher", false]], "src.launcher.launcher": [[5, "module-src.launcher.launcher", false]], "src.model": [[6, "module-src.model", false]], "src.model.config": [[6, "module-src.model.config", false]], "src.tokenizer": [[7, "module-src.tokenizer", false]], "src.tokenizer.config": [[7, "module-src.tokenizer.config", false]], "src.trainer": [[8, "module-src.trainer", false]], "src.trainer.config": [[8, "module-src.trainer.config", false]], "src.trainer.postprocess_trainer": [[8, "module-src.trainer.postprocess_trainer", false]], "src.trainer.preprocess_args": [[8, "module-src.trainer.preprocess_args", false]], "src.utils": [[9, "module-src.utils", false]], "src.utils.custom": [[9, "module-src.utils.custom", false]], "src.utils.file_util": [[9, "module-src.utils.file_util", false]], "src.utils.func_util": [[9, "module-src.utils.func_util", false]], "src.utils.list_util": [[9, "module-src.utils.list_util", false]], "src.utils.node": [[9, "module-src.utils.node", false]], "src.utils.rank": [[9, "module-src.utils.rank", false]], "subproc_accelerate (src.launcher.launcher.launcherconfig attribute)": [[5, "src.launcher.launcher.LauncherConfig.subproc_accelerate", false]], "subproc_deepspeed (src.launcher.launcher.launcherconfig attribute)": [[5, "src.launcher.launcher.LauncherConfig.subproc_deepspeed", false]], "subproc_deepspeed_stage (src.launcher.launcher.launcherconfig attribute)": [[5, "src.launcher.launcher.LauncherConfig.subproc_deepspeed_stage", false]], "subprocess_run_args() (src.launcher.launcher.launcherconfig method)": [[5, "src.launcher.launcher.LauncherConfig.subprocess_run_args", false]], "tokenizer (src.trainer.config.trainconfig attribute)": [[8, "src.trainer.config.TrainConfig.tokenizer", false]], "tokenizerconfig (class in src.tokenizer.config)": [[7, "src.tokenizer.config.TokenizerConfig", false]], "trainconfig (class in src.trainer.config)": [[8, "src.trainer.config.TrainConfig", false]], "trainer (src.trainer.config.trainconfig attribute)": [[8, "src.trainer.config.TrainConfig.trainer", false]], "use_as (src.data.config.dataelem attribute)": [[4, "src.data.config.DataElem.use_as", false]], "use_cache (src.data.config.dataelem attribute)": [[4, "src.data.config.DataElem.use_cache", false]], "world_size() (in module src.utils.rank)": [[9, "src.utils.rank.world_size", false]], "write_csv() (in module src.utils.file_util)": [[9, "src.utils.file_util.write_csv", false]], "write_jsonl() (in module src.utils.file_util)": [[9, "src.utils.file_util.write_jsonl", false]], "write_magic() (in module src.utils.file_util)": [[9, "src.utils.file_util.write_magic", false]], "write_tsv() (in module src.utils.file_util)": [[9, "src.utils.file_util.write_tsv", false]], "write_txt() (in module src.utils.file_util)": [[9, "src.utils.file_util.write_txt", false]], "write_yaml() (in module src.utils.file_util)": [[9, "src.utils.file_util.write_yaml", false]]}, "objects": {"": [[2, 0, 0, "-", "src"]], "src": [[3, 0, 0, "-", "base"], [4, 0, 0, "-", "data"], [2, 0, 0, "-", "env"], [5, 0, 0, "-", "launcher"], [6, 0, 0, "-", "model"], [7, 0, 0, "-", "tokenizer"], [8, 0, 0, "-", "trainer"], [9, 0, 0, "-", "utils"]], "src.base": [[3, 0, 0, "-", "base_config"], [3, 0, 0, "-", "base_instance"], [3, 0, 0, "-", "base_message"]], "src.base.base_config": [[3, 1, 1, "", "BaseConfig"], [3, 1, 1, "", "CallConfig"]], "src.base.base_config.BaseConfig": [[3, 2, 1, "", "dump"], [3, 2, 1, "", "load"], [3, 3, 1, "", "model_config"]], "src.base.base_config.CallConfig": [[3, 2, 1, "", "get_kwargs"], [3, 3, 1, "", "model_config"], [3, 3, 1, "", "name"]], "src.base.base_instance": [[3, 1, 1, "", "Instance"]], "src.base.base_instance.Instance": [[3, 3, 1, "", "data_index"], [3, 3, 1, "", "data_source"], [3, 3, 1, "", "elem"], [3, 3, 1, "", "model_config"], [3, 3, 1, "", "passages"]], "src.base.base_message": [[3, 1, 1, "", "BaseMessage"], [3, 1, 1, "", "Passage"], [3, 1, 1, "", "PreferenceMessage"]], "src.base.base_message.BaseMessage": [[3, 3, 1, "", "message"], [3, 3, 1, "", "model_config"], [3, 2, 1, "", "process_speaker"], [3, 3, 1, "", "speaker"]], "src.base.base_message.Passage": [[3, 3, 1, "", "model_config"], [3, 3, 1, "", "passage"], [3, 3, 1, "", "passage_title"]], "src.base.base_message.PreferenceMessage": [[3, 3, 1, "", "model_config"], [3, 3, 1, "", "rejected_message"]], "src.data": [[4, 0, 0, "-", "config"], [4, 0, 0, "-", "filter"], [4, 0, 0, "-", "formatter"], [4, 0, 0, "-", "reader"]], "src.data.config": [[4, 1, 1, "", "DataConfig"], [4, 1, 1, "", "DataElem"]], "src.data.config.DataConfig": [[4, 3, 1, "", "custom_builder"], [4, 3, 1, "", "filter"], [4, 3, 1, "", "formatter"], [4, 2, 1, "", "info"], [4, 3, 1, "", "model_config"], [4, 3, 1, "", "reader"], [4, 3, 1, "", "sources"]], "src.data.config.DataElem": [[4, 3, 1, "", "custom_builder"], [4, 3, 1, "", "dataset"], [4, 3, 1, "", "filter"], [4, 3, 1, "", "formatter"], [4, 2, 1, "", "info"], [4, 3, 1, "", "limit"], [4, 3, 1, "", "model_config"], [4, 3, 1, "", "name"], [4, 3, 1, "", "raw_reader"], [4, 3, 1, "", "reader"], [4, 3, 1, "", "source"], [4, 3, 1, "", "split"], [4, 3, 1, "", "split_dev"], [4, 3, 1, "", "use_as"], [4, 3, 1, "", "use_cache"]], "src.data.filter": [[4, 4, 1, "", "get_filter"]], "src.data.formatter": [[4, 4, 1, "", "get_formatter"]], "src.data.reader": [[4, 4, 1, "", "get_reader"]], "src.launcher": [[5, 0, 0, "-", "launcher"]], "src.launcher.launcher": [[5, 1, 1, "", "LauncherConfig"]], "src.launcher.launcher.LauncherConfig": [[5, 3, 1, "", "accelerate_config"], [5, 2, 1, "", "create_accelerate_args"], [5, 3, 1, "", "deepspeed_config"], [5, 5, 1, "", "is_deepspeed"], [5, 3, 1, "", "is_main"], [5, 3, 1, "", "local_rank"], [5, 3, 1, "", "model_config"], [5, 3, 1, "", "nodes"], [5, 3, 1, "", "run_config"], [5, 3, 1, "", "subproc_accelerate"], [5, 3, 1, "", "subproc_deepspeed"], [5, 3, 1, "", "subproc_deepspeed_stage"], [5, 2, 1, "", "subprocess_run_args"]], "src.model": [[6, 0, 0, "-", "config"]], "src.model.config": [[6, 1, 1, "", "ModelConfig"]], "src.model.config.ModelConfig": [[6, 3, 1, "", "device"], [6, 3, 1, "", "load_weight"], [6, 3, 1, "", "model_config"], [6, 3, 1, "", "model_type"], [6, 3, 1, "", "path"]], "src.tokenizer": [[7, 0, 0, "-", "config"]], "src.tokenizer.config": [[7, 1, 1, "", "TokenizerConfig"]], "src.tokenizer.config.TokenizerConfig": [[7, 3, 1, "", "model_config"], [7, 3, 1, "", "path"]], "src.trainer": [[8, 0, 0, "-", "config"], [8, 0, 0, "-", "postprocess_trainer"], [8, 0, 0, "-", "preprocess_args"]], "src.trainer.config": [[8, 1, 1, "", "TrainConfig"], [8, 4, 1, "", "create_trainer"]], "src.trainer.config.TrainConfig": [[8, 3, 1, "", "data"], [8, 3, 1, "", "deepspeed_stage"], [8, 3, 1, "", "is_accelerate"], [8, 3, 1, "", "is_deepspeed"], [8, 3, 1, "", "loss"], [8, 3, 1, "", "model"], [8, 3, 1, "", "model_config"], [8, 3, 1, "", "model_name"], [8, 3, 1, "", "optimizer"], [8, 5, 1, "", "save_dir"], [8, 3, 1, "", "scheduler"], [8, 3, 1, "", "tokenizer"], [8, 3, 1, "", "trainer"]], "src.trainer.postprocess_trainer": [[8, 4, 1, "", "SFTTrainer"]], "src.trainer.preprocess_args": [[8, 4, 1, "", "as_callable"], [8, 4, 1, "", "loss"], [8, 4, 1, "", "optimizer"], [8, 4, 1, "", "reward_funcs"]], "src.utils": [[9, 0, 0, "-", "custom"], [9, 0, 0, "-", "file_util"], [9, 0, 0, "-", "func_util"], [9, 0, 0, "-", "list_util"], [9, 0, 0, "-", "node"], [9, 0, 0, "-", "rank"]], "src.utils.custom": [[9, 4, 1, "", "load_module"]], "src.utils.file_util": [[9, 4, 1, "", "iter_dir"], [9, 4, 1, "", "read_csv"], [9, 4, 1, "", "read_jsonl"], [9, 4, 1, "", "read_magic"], [9, 4, 1, "", "read_tsv"], [9, 4, 1, "", "read_txt"], [9, 4, 1, "", "read_yaml"], [9, 4, 1, "", "write_csv"], [9, 4, 1, "", "write_jsonl"], [9, 4, 1, "", "write_magic"], [9, 4, 1, "", "write_tsv"], [9, 4, 1, "", "write_txt"], [9, 4, 1, "", "write_yaml"]], "src.utils.func_util": [[9, 4, 1, "", "autocast"], [9, 4, 1, "", "create_get_fn"], [9, 4, 1, "", "create_register_deco"], [9, 4, 1, "", "drop_unused_args"]], "src.utils.list_util": [[9, 4, 1, "", "concat"]], "src.utils.node": [[9, 4, 1, "", "is_localhost"], [9, 4, 1, "", "parse_nodelist"]], "src.utils.rank": [[9, 4, 1, "", "is_rank_zero"], [9, 4, 1, "", "rank"], [9, 4, 1, "", "rank_iter"], [9, 4, 1, "", "rank_zero_only"], [9, 4, 1, "", "rank_zero_print"], [9, 4, 1, "", "world_size"]]}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "function", "Python function"], "5": ["py", "property", "Python property"]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:attribute", "4": "py:function", "5": "py:property"}, "terms": {"0": 4, "001": 9, "003": 9, "01": 9, "03": 9, "05": 9, "0\uc778": 9, "1": 9, "10": 4, "2": [4, 9], "__call__\uc744": 3, "__name__": 9, "acceler": 5, "accelerate_config": [2, 5], "add": 0, "allow": [3, 4, 5, 6, 7, 8], "ani": [3, 4, 5, 6, 7, 8], "arbitrary_types_allow": 4, "arg": 9, "argument\ub4e4\uc744": 5, "as_cal": [2, 8], "assistant\uc758": 3, "autocast": [2, 9], "a\uc5d0\uac8c": 9, "base": [1, 2, 4, 5, 6, 7, 8], "base_config": [1, 2, 4], "base_inst": [1, 2], "base_messag": [1, 2], "baseconfig": [2, 3, 4, 5, 6, 7, 8], "basemessag": [2, 3, 4], "basemodel": 3, "blob": 4, "bool": [4, 5, 6, 8], "cach": 4, "callabl": 9, "callable\uc774\ub098": 9, "callconfig": [2, 3, 4, 8, 9], "callconfig\ub97c": 4, "call\ud558\ub294": 4, "card": [4, 6], "chatgpt": 9, "class": [3, 4, 5, 6, 7, 8, 9], "classmethod": 3, "classvar": [3, 4, 5, 6, 7, 8], "class\ub97c": [4, 9], "class\uc758": 9, "co": 4, "com": 4, "command": 5, "command\ub97c": 5, "concat": [2, 9], "config": [1, 2, 3, 5], "configdict": [3, 4, 5, 6, 7, 8], "configur": [3, 4, 5, 6, 7, 8], "config\uac00": 8, "config\ub97c": [3, 8], "config\uc5d0": 4, "config\uc758": 3, "conform": [3, 4, 5, 6, 7, 8], "content": 1, "context": 9, "create_accelerate_arg": [2, 5], "create_get_fn": [2, 9], "create_register_deco": [2, 9], "create_register_deco\uc5d0": 9, "create_train": [2, 8], "custom": [1, 2], "custom_build": [2, 4], "d": 9, "data": [1, 2, 8, 9], "data_index": [2, 3], "data_sourc": [2, 3], "dataconfig": [2, 4, 8], "dataelem": [2, 4], "dataset": [2, 4], "dataset_dict": 4, "dataset_format": 4, "datasetdict": 4, "dataset\uc744": 4, "data\ub97c": 4, "decorator\ub97c": 9, "deepspe": [5, 8], "deepspeed_config": [2, 5], "deepspeed_stag": [2, 8], "deepspeed_util": [1, 2], "deepspeed\uc640": 5, "default": [4, 5], "delimit": 9, "deprec": 9, "detail": 0, "devic": [2, 6], "dev\ub85c": 4, "dict": 9, "dictionari": [3, 4, 5, 6, 7, 8], "dictionary\ub97c": 9, "dict\ub098": 4, "dict\ub97c": 9, "directory\uc5d0\uc11c": 9, "distribut": [5, 9], "doc": 4, "drop_unused_arg": [2, 9], "dummi": 9, "dump": [2, 3], "elem": [2, 3], "element": 3, "en": 4, "env": 1, "everi": 3, "ext": 9, "extension\uc5d0": 9, "extra": [3, 4, 5, 6, 7, 8], "extra_data": [3, 4, 5, 6, 7, 8], "f": 9, "factori": 4, "fals": [4, 5, 6, 8, 9], "field\uc758": 4, "file": [5, 6, 9], "file_util": [1, 2], "file\uc744": 5, "filter": [1, 2], "filter_postfix": 9, "filter_prefix": 9, "fn": 9, "foramtter\ub97c": 4, "formatt": [1, 2], "formatter\ub97c": 4, "func_util": [1, 2], "function": 4, "gener": [3, 9], "get_filt": [2, 4], "get_fn": 9, "get_formatt": [2, 4], "get_kwarg": [2, 3], "get_read": [2, 4], "github": 4, "global": 9, "gpu": 9, "hf": 4, "hint": 9, "hint\ub97c": 9, "host": 9, "http": 4, "huggingfac": [4, 6], "idx": 5, "infer": [6, 7], "inference\uc5d0": 3, "info": [2, 4], "init": 6, "inst": 9, "instanc": [2, 3], "instance_nam": 9, "instance\ub97c": 4, "int": [3, 4, 5, 8], "io": 9, "is_acceler": [2, 8], "is_deepspe": [2, 5, 8], "is_localhost": [2, 9], "is_main": [2, 5], "is_rank_zero": [2, 9], "iter_dir": [2, 9], "iterabledatasetdict": 4, "iterable\uc744": 9, "json": [3, 4], "keyword": 9, "kwarg": [8, 9], "kwargs\ub97c": 4, "kwarg\ub97c": 3, "l": 9, "l78": 4, "launcher": [1, 2], "launcherconfig": [2, 5], "level\uc5d0\uc11c": 9, "limit": [2, 4], "line\uc5d0\uc11c": 5, "list": [3, 4, 9], "list_util": [1, 2], "list\ub85c": 3, "llm": 3, "load": [2, 3, 4, 6], "load_modul": [2, 9], "load_weight": [2, 6], "load\uc640": 3, "load\ud560": 3, "local_rank": [2, 5], "loss": [2, 8], "main": [4, 5], "manager\ub85c": 9, "messag": [2, 3, 4], "message\ub97c": 4, "metadata\uc640": 3, "model": [1, 2, 3, 4, 5, 7, 8], "model_config": [2, 3, 4, 5, 6, 7, 8], "model_nam": [2, 8], "model_typ": [2, 6], "modelconfig": [2, 6, 8], "model\uc758": 8, "modul": 1, "module_nam": 9, "moduletyp": 9, "module\uc774": 4, "multiprocessing\uc774": 9, "must": 7, "name": [2, 3, 4, 9], "node": [1, 2, 5], "node001": 9, "node002": 9, "node003": 9, "node01": 9, "node02": 9, "node03": 9, "node05": 9, "node1": 9, "node2": 9, "nodea": 9, "nodeb": 9, "nodelist": 9, "node\ub97c": 5, "node\ub9c8\ub2e4": 5, "none": [3, 4, 5, 6, 8, 9], "num_worker\uac19\uc740": 9, "optim": [2, 8], "option": [4, 9], "option\uc774": 9, "p": 9, "packag": [0, 1], "paramet": [4, 9], "parse_nodelist": [2, 9], "partial": 4, "passag": [2, 3], "passage_titl": [2, 3], "passagetitl": 3, "path": [2, 3, 5, 6, 7], "path\ub97c": 5, "path\uc5d0": 8, "pickling\uc774": 9, "pipelin": 3, "pipeline\uc5d0": 3, "postfix": 9, "postprocess_train": [1, 2], "preferencemessag": [2, 3], "prefix": 9, "preprocess_arg": [1, 2], "process": 5, "process_speak": [2, 3], "process\ub97c": 5, "properti": [5, 8], "protocol\uc744": 9, "py": [4, 5], "pydant": [3, 4, 5, 6, 7, 8], "python": 5, "py\ub97c": 5, "rais": 4, "rank": [1, 2], "rank_it": [2, 9], "rank_zero_onli": [2, 9], "rank_zero_print": [2, 9], "rank\uac00": 9, "rank\uc640": 9, "raw": 4, "raw_read": [2, 4], "read_csv": [2, 9], "read_jsonl": [2, 9], "read_mag": [2, 9], "read_tsv": [2, 9], "read_txt": [2, 9], "read_yaml": [2, 9], "reader": [1, 2], "readerelem\ub4e4": 4, "readerelem\uc5d0": 4, "reader\ub97c": [4, 9], "registri": 9, "registry\uac00": 4, "registry\uc5d0\uc11c": 9, "rejected_messag": [2, 3], "restructuredtext": 0, "return": [4, 9], "return_absolut": 9, "return\ud558\ub294": 9, "reward_func": [2, 8], "run": 5, "run_config": [2, 5], "runnabl": 5, "save_dir": [2, 8], "schedul": [2, 8], "see": 0, "sft": 8, "sfttrainer": [2, 8], "should": [3, 4, 5, 6, 7, 8], "size\ub97c": 9, "skip\ud568": 9, "slice": 4, "slurm": 5, "slurm\uc758": 9, "sourc": [2, 3, 4, 5, 6, 7, 8, 9], "speaker": [2, 3], "split": [2, 4], "split_dev": [2, 4], "split\uc744": 4, "src": 0, "str": [3, 4, 5, 6, 7, 8, 9], "submodul": 1, "subpackag": 1, "subproc_acceler": [2, 5], "subproc_deepspe": [2, 5], "subproc_deepspeed_stag": [2, 5], "subprocess_run_arg": [2, 5], "subprocess\uc758": 5, "support": 5, "sy": 9, "sync": 7, "syntax": 0, "system": 3, "t": [3, 4, 9], "target\ub9cc": 8, "todo": 9, "token": [1, 2, 8], "tokenizerconfig": [2, 7, 8], "tokenizer\ub97c": 8, "train": [6, 7], "trainconfig": [2, 8], "trainer": [1, 2], "trainer\ub97c": 8, "trainer\uc5d0": 4, "trl": 4, "true": [3, 4, 5, 6, 7, 8], "true\ub85c": 4, "type": [4, 9], "type_hint": 9, "type_hint\uc5d0": 9, "typing\uc758": 9, "us": 0, "use_a": [2, 4], "use_cach": [2, 4], "use_enum_valu": [3, 4, 5, 6, 7, 8], "user": 3, "util": [1, 2], "v": [3, 8], "v3": 4, "valueerror": 4, "value\uac00": 9, "weight": 6, "without": 6, "world": 9, "world_siz": [2, 9], "write_csv": [2, 9], "write_jsonl": [2, 9], "write_mag": [2, 9], "write_tsv": [2, 9], "write_txt": [2, 9], "write_yaml": [2, 9], "writer\ub97c": 9, "xxx_config": 5, "xxx\ub97c": 5, "yaml": 3, "your": 0, "\uac00\uacf5": 4, "\uac00\uacf5\ud558\ub294": 4, "\uac00\ub2a5": 9, "\uac00\uc838\uc634": 4, "\uac00\uc9c0\uace0": 9, "\uac01": 3, "\uac01\uac01\uc758": [4, 5], "\uac12": 5, "\uac12\uc744": 4, "\uac19\uc74c": 9, "\uac1c\ubcc4": 4, "\uac83": [3, 5, 9], "\uac83\uc774": 9, "\uac83\uc778\uac00": 9, "\uac83\uc784": 4, "\uacb0\uacfc\ub294": 8, "\uacbd\ub85c": 4, "\uacbd\uc6b0": [4, 5, 8], "\uacbd\uc6b0\uc5d0\ub294": 9, "\uacfc\uc815\uc5d0\uc11c": 6, "\uad00\ub828": 9, "\uad6c\ubd84\uc6a9": 5, "\uad6c\uc131": 3, "\uad6c\ud604\ud558\uba74": 3, "\uad6c\ud604\ud560": 3, "\uadf8\uc5d0": 5, "\uae08\uc9c0": 8, "\uae30\ub85d\uc6a9\uc73c\ub85c\ub9cc": 6, "\uae30\ubc18\uc73c\ub85c": [4, 5], "\ub098\ud0c0\ub0b4\ub294": 3, "\ub178\ub4dc": 9, "\ub294": 4, "\ub2f4\uc740": 9, "\ub300\uc0c1": 9, "\ub300\uc2e0": 9, "\ub300\ud55c": 9, "\ub300\ud654\ub97c": 3, "\ub36e\uc5b4\uc50c\uc6cc\uc9d0": 6, "\ub370\uc774\ud130\ub97c": [4, 8], "\ub370\uc774\ud130\uc14b": 4, "\ub370\ucf54\ub808\uc774\ud130": 9, "\ub370\ucf54\ub808\uc774\ud130\ub85c": 9, "\ub3d9\uc791\uc774": 3, "\ub4a4": [4, 9], "\ub4f1\uc744": 5, "\ub514\ub809\ud1a0\ub9ac": 9, "\ub530\ub77c\uc11c": 9, "\ub54c": [3, 5, 9], "\ub610\ub294": [3, 4, 5, 9], "\ub85c\ub4dc": 9, "\ub85c\ub4dc\ud560": 9, "\ub97c": 5, "\ub9ac\uc2a4\ud2b8": 9, "\ub9ac\uc2a4\ud2b8\ub85c": 9, "\ub9ac\uc2a4\ud2b8\ub97c": 9, "\ub9c8\uc138\uc694": 5, "\ub9cc\ub4dc\ub294": 9, "\ub9cc\ub4e0": 9, "\ub9d0": 5, "\ub9de\uac8c": 4, "\ub9de\ub294": [4, 5], "\uba54\uc778": 8, "\ubaa8\ub378": 8, "\ubaa8\ub378\uc5d0": 8, "\ubaa8\ub378\uc758": 6, "\ubaa8\ub378\uc774": 8, "\ubaa8\ub4c8": 9, "\ubaa8\ub4c8\uc5d0\uc11c": 9, "\ubaa8\ub4c8\uc744": 9, "\ubaa8\ub4e0": 3, "\ubb38\uc790\uc5f4": 9, "\ubb38\uc790\uc5f4\uc744": 9, "\ubbf8\uad6c\ud604": 5, "\ubbf8\ub9ac": 5, "\ubc18\ub4dc\uc2dc": [5, 9], "\ubc18\ud658": 4, "\ubc18\ud658\ud569\ub2c8\ub2e4": 9, "\ubc1b\uc544\uc11c": 9, "\ubc29\ubc95": 4, "\ubc29\ubc95\uc744": 4, "\ubc29\uc2dd\uc73c\ub85c": 3, "\ubcc0\ud658\ud558\ub294": 4, "\ubcc4\ub3c4\ub85c": 9, "\ubd80\ubd84\uc73c\ub85c": 4, "\ubd84\ud560": 4, "\ubd88\ub7ec\uc624\uace0": [3, 9], "\ubd88\ub7ec\uc624\ub294": 9, "\ubd88\ub7ec\uc628": 4, "\ubd88\ub7ec\uc62c": [4, 9], "\ubd88\ub7ec\uc634": 4, "\uc0ac\uc6a9": [3, 4, 8, 9], "\uc0ac\uc6a9\ub418\ub294": 3, "\uc0ac\uc6a9\ud558\ub294": [3, 5, 9], "\uc0ac\uc6a9\ud558\ub294\ub2e8\uc704": 3, "\uc0ac\uc6a9\ud558\uba74": 9, "\uc0ac\uc6a9\ud558\uc5ec": [3, 4, 5, 8], "\uc0ac\uc6a9\ud558\uc9c0": 6, "\uc0ac\uc6a9\ud55c": [4, 9], "\uc0ac\uc6a9\ud560": [3, 5, 8, 9], "\uc0ac\uc6a9\ud568": [4, 6], "\uc0dd\uc131": 9, "\uc0dd\uc131\ud569\ub2c8\ub2e4": 8, "\uc120\ud0dd\ud558\uc5ec": 9, "\uc124\uc815": [5, 8], "\uc124\uc815\ub418\ubbc0\ub85c": 5, "\uc124\uc815\uc2dc": 4, "\uc124\uc815\uc744": 8, "\uc124\uc815\ud558\uba74": 4, "\uc124\uc815\ud558\uc9c0": 5, "\uc218\ub3d9": 8, "\uc218\ub3d9\uc73c\ub85c": 5, "\uc2dc": 4, "\uc2e4\uc81c": [3, 6, 9], "\uc2e4\ud589": 5, "\uc2e4\ud589\ub418\ub294": 3, "\uc2e4\ud589\ub418\ub3c4\ub85d": 9, "\uc2e4\ud589\ud558\uace0": 5, "\uc2e4\ud589\ud560": 5, "\uc2e4\ud589\ud568": 5, "\uc2f6\uc744": [5, 9], "\uc4f0\uae30": 9, "\uc500": 4, "\uc544\ub2cc": 4, "\uc548\ub3fc\uc11c": 9, "\uc548\ub418\uace0": 9, "\uc548\uba39\ud798": 9, "\uc54a\uace0": 6, "\uc54a\uc744": 4, "\uc5b4\ub5bb\uac8c": 9, "\uc5c6\uc744": 8, "\uc5ec\ub7ec": 9, "\uc5ec\ubd80": 4, "\uc608\uc81c": 9, "\uc6b0\ud68c": 9, "\uc704\ud55c": [5, 8], "\uc73c\ub85c": 9, "\uc758": 4, "\uc774": [4, 8, 9], "\uc774\ub984": [3, 4, 8, 9], "\uc774\ub984\ub4e4\uc758": 9, "\uc774\ub984\uc744": [3, 9], "\uc774\ud6c4": 9, "\uc778\uc790\ub4e4\uc744": 9, "\uc778\uc790\ub85c": 9, "\uc77c\ubd80\ub97c": 9, "\uc77d\uc5b4\uc11c": 5, "\uc77d\uc5b4\uc624\ub294": 4, "\uc77d\uc5b4\uc634": 9, "\uc77d\uc740": 4, "\uc785\ub825": [4, 5], "\uc788\ub294": 9, "\uc788\uc744": 8, "\uc790\ub3d9": 5, "\uc800\uc7a5\ub41c": 4, "\uc800\uc7a5\ub420": 8, "\uc800\uc7a5\ub428": 8, "\uc801\ud569\ud55c": 4, "\uc804\ub2ec": 9, "\uc804\ub2ec\ud558\ub294\ub370": 3, "\uc804\ub2ec\ud558\uba74": 5, "\uc804\ub2ec\ud558\uc5ec": 4, "\uc804\ub2ec\ud560": 9, "\uc804\ub2ec\ud574": 9, "\uc815\uc758": [4, 5, 8], "\uc815\uc758\ud558\ub294": 4, "\uc815\uc758\ud558\uc9c0": 4, "\uc815\uc758\ud55c": 9, "\uc815\uc758\ud560": 9, "\uc815\ud574\uc904": 5, "\uc81c\ud55c": 4, "\uc88b\uc744": 9, "\uc8fc\uc138\uc694": 9, "\uc9c0\uc6d0": 3, "\uc9c0\uc815\ud558\ub824\uba74": 9, "\uc9c4\ud589": 4, "\uc9c4\ud589\ud560": 8, "\uc9c4\ud589\ud568": 4, "\ucc38\uace0": 4, "\ucc98\ub9ac\ud558\ub294": 9, "\ucc98\ub9ac\ud560": 9, "\ucd1d\ub7c9": 4, "\ucd94\uac00\ud569\ub2c8\ub2e4": 8, "\ucf54\ub4dc": 8, "\ucf54\ub4dc\uc5d0\uc11c\ub294": 6, "\ud0c0\uc785": 6, "\ud14c\uc2a4\ud2b8": 9, "\ud1b5\ud574": 5, "\ud2b9\uc815": 9, "\ud30c\uc2f1\ud558\uc5ec": 9, "\ud30c\uc2f1\ud560": 9, "\ud30c\uc774\ud504\ub77c\uc778\uc5d0": 3, "\ud30c\uc77c\ub85c\ubd80\ud130": 3, "\ud30c\uc77c\uc744": [4, 5], "\ud30c\uc77c\uc758": 5, "\ud3b8\uc758": 9, "\ud504\ub85c\uc138\uc2a4\uc5d0\uc11c\ub9cc": 9, "\ud544\uc694": 9, "\ud544\uc694\ud55c": [3, 8], "\ud544\ud130\ub9c1": 4, "\ud558\ub098": 9, "\ud558\ub098\ub85c": 9, "\ud558\ub294": 9, "\ud559\uc2b5": [3, 8], "\ud559\uc2b5\uc5d0": [3, 8], "\ud559\uc2b5\uc744": 8, "\ud559\uc2b5\ud558\uae30": 8, "\ud560": 8, "\ud568\uaed8": 5, "\ud568\uc218": [3, 4, 9], "\ud568\uc218\ub098": [3, 4, 9], "\ud568\uc218\ub4e4": 9, "\ud568\uc218\ub97c": [4, 9], "\ud568\uc218\uc5d0": 9, "\ud568\uc218\uc758": 9, "\ud569\uce69\ub2c8\ub2e4": 9, "\ud574\ub2f9": [3, 5, 9], "\ud574\uc11d\ud558\uace0": 5, "\ud615\ud0dc\ub85c": 4, "\ud638\ucd9c\ud560": 9, "\ud655\uc7a5\ub41c": 9, "\ud658\uacbd\uc5d0\uc11c": 9, "\ud658\uacbd\uc744": 5}, "titles": ["Trainer documentation", "src", "src package", "src.base package", "src.data package", "src.launcher package", "src.model package", "src.tokenizer package", "src.trainer package", "src.utils package"], "titleterms": {"base": 3, "base_config": 3, "base_inst": 3, "base_messag": 3, "config": [4, 6, 7, 8], "content": [0, 2, 3, 4, 5, 6, 7, 8, 9], "custom": 9, "data": 4, "deepspeed_util": 9, "document": 0, "env": 2, "file_util": 9, "filter": 4, "formatt": 4, "func_util": 9, "launcher": 5, "list_util": 9, "model": 6, "modul": [2, 3, 4, 5, 6, 7, 8, 9], "node": 9, "packag": [2, 3, 4, 5, 6, 7, 8, 9], "postprocess_train": 8, "preprocess_arg": 8, "rank": 9, "reader": 4, "src": [1, 2, 3, 4, 5, 6, 7, 8, 9], "submodul": [2, 3, 4, 5, 6, 7, 8, 9], "subpackag": 2, "token": 7, "trainer": [0, 8], "util": 9}})